@startuml

package model {
    class DonneesSimulation {
        -Carte carte
        -Map<Case, Incendie> incendiesParCase
        -List<Robot> robots

        +DonneesSimulation()
        +Carte getCarte()
        +Map<Case, Incendie> getIncendies()
        +List<Robot> getRobots()
        +String toString()
    }

    package map {
        class Carte {
            -int nbLignes
            -int nbColonnes
            -Case[][] cases
            -int tailleCases

            +Carte(int nbLignes, int nbColonnes, int tailleCases, Case[][] cases)

            +int getNbLignes()
            +int getNbColonnes()
            +int getTailleCases()
            +Case getCase()
            +Case getVoisin()
            +boolean caseExiste(Case src)
            +boolean estVoisin(Case src, Case dest)
            +boolean estIndiceValide(int lig, int col)
            +String toString()
        }

        class Case {
            -int ligne
            -int colonne
            -NatureTerrain nature
            -Color drawColor

            +Case(int ligne, int colonne, NatureTerrain natureTerrain)
            +int getLigne()
            +int getColonne()
            +Color getDrawColor()
            +NatureTerrain getNature() 
            +String toString()
        }

        enum Direction {
            NORD,
            SUD,
            EST,
            OUEST
        }

        class Incendie {
            -Case position
            -int quantiteEau
            -Color drawColor

            +Incendie(Case position, int quantiteEau)
            +Case getPosition()
            +Color getDrawColor()
            +int getQuantiteEau()
            +void eteindre(int quantiteEau)
            +String toString()
        }
        class NatureTerrain{
            EAU,
            FORET,
            ROCHE,
            TERRAIN_LIBRE,
            HABITAT

            +Color getDrawColor()
        }
    }

    package robot {
        abstract class Robot {
            -int niveauEau
            -int capaciteReservoir
            -int tempsRemplissage
            -int interUnitaire
            -double vitesseMax
            -Case position
            -EtatRobot etatCourant
            -Case positionApresEvenements
            -long dateApresEvenements
            #Carte carte
            #double vitesse

            +Robot(Case position, int niveauEau int capaciteReservoir, double vitesse, double vitesseMax, int tempsRemplissage, Carte carte, int interUnitaire)
            +Case getPosition()
            +int getNiveauEau()
            +Color getDrawColor()
            +int getCapaciteReservoir()
            +int getTempsRemplissage()
            +boolean estOccupe()
            +int getInterUnitaire()
            +EtatRobot getEtatCourant()
            +void setEtatCourant(EtatRobot newEtat)
            +Case getPositionApresEvenements()
            +void setNiveauEau(int niveauEau)
            +void deverserEau(int quantite, Incendie incendie)
            +void setVitesse(double newVitesse)
            +double calculerTempsDeplacementMinute(Case caseDepart, Case caseArrivee)
            +void setPosition(Case newPosistion)
            +String getImagePath()
            +String toString()
            +void createEvenementsDeplacement(Simulateur simulateur, Case nouvellePosition)
            +void deplacementPlusCourtChemin(Simulateur simulateur, Case destination, PlusCourtChemin algo)
            +void createEvenementsInterventionIncendie(Simulateur simulateur, Incendie incendie)
            +void createEvenementsRemplirReservoir(Simulateur simulateur)
            -{static} void checkNiveauEau(int niveauEau, int capaciteReservoir)
            -{static} void checkVitesse(double vitesse, double vitesseMax)
            +{abstract} double getVitesse(NatureTerrain terrain)
            +{abstract}checkPosition(Case position, Carte carte)
            +{abstract} void remplirReservoir()
        }

        abstract class RobotAerien extends Robot {
            +RobotAerien(Case position, int niveauEau, int capaciteReservoir, double vitesse, double vitesseMax, int tempsRemplissage, Carte carte, int interUnitaire)
            +void remplirReservoir()
        }
        abstract class RobotTerrestre extends Robot{
            +RobotTerrestre(Case position, int niveauEau, int capaciteReservoir, double vitesse, double vitesseMax,
            int tempsRemplissage, Carte carte, int interUnitaire)
            +void remplirReservoir()
        }
        class RobotChenilles extends RobotTerrestre{
            -{final} int CAPACITE_RESERVOIR
            -{final} double NIVEAU_EAU
            -{final} double VITESSE_DEFAUT
            -{final} double VITESSE_MAX
            -{final} int TEMPS_REMPLISSAGE
            -{final} int INTER_UNITAIRE

            +RobotChenilles(Case position, Carte carte, double vitesse)
            +double getVitesse(NatureTerrain terrain)
            +String getImagePath()
            +{static} checkPositionStatic(Case position, Carte carte)
            +checkPosition(Case position, Carte carte)
            +{static} RobotChenilles createRobotChenilles(Case caseCourante, Carte carte, double vitesseLue)
        }
        class RobotPattes extends RobotTerrestre{
            -{final} int CAPACITE_RESERVOIR
            -{final} double NIVEAU_EAU
            -{final} double VITESSE_DEFAUT
            -{final} double VITESSE_MAX
            -{final} int TEMPS_REMPLISSAGE
            -{final} int INTER_UNITAIRE

            +RobotPattes(Case position, Carte carte)
            +double getVitesse(NatureTerrain terrain)
            +void deverserEau(int vol, Incendie)
            +{static} checkPositionStatic(Case position, Carte carte)
            +void checkPosition(Case position, Carte carte)
            +String getImagePath()
            +{static} RobotPattes createRobotPattes(Case caseCourante, Carte carte)
        }
            
        }

        class RobotRoues extends RobotTerrestre{
            -{final} int CAPACITE_RESERVOIR
            -{final} double NIVEAU_EAU
            -{final} double VITESSE_DEFAUT
            -{final} double VITESSE_MAX
            -{final} int TEMPS_REMPLISSAGE
            -{final} int INTER_UNITAIRE

            +RobotRoues(Case position, Carte carte, double vitesse)
            +double getVitesse(NatureTerrain terrain)
            +String getImagePath()
            +{static} void checkPositionStatic(Case position, Carte carte)
            +void checkPosition(Case position, Carte carte)
            +{static} RobotRoues createRobotRoues(Case caseCourante, Carte carte, double vitesseLue)
        }

        class Drone extends RobotAerien{
            -{final} int CAPACITE_RESERVOIR
            -{final} double NIVEAU_EAU
            -{final} double VITESSE_DEFAUT
            -{final} double VITESSE_MAX
            -{final} int TEMPS_REMPLISSAGE
            -{final} int INTER_UNITAIRE

            +Drone(Case position, Carte carte, double vitesse)
            +void checkPosition()
            +String getImagePath()
        }

        class RobotFactory{
            +{static} Robot getRobot(String typeRobot, Case caseCourante, Carte carte, double vitesseLue)
        }

    }



package simu {
    class Simulateur implements Simulable {
        -GUISimulator gui
        -DonneesSimulation model
        -long dateSimulation
        -PriorityQueue<Evenement> evenements
        -{final} int RATIO_BORDURE_X
        -{final} int RATIO_BORDURE_Y
        -int taillePixelCases
        -int xMin
        -int yMin

        +Simulateur(GUISimulator gui, DonneesSimulation model)
        +void ajouteEvenement(Evenement e)
        -void incrementeDate()
        -boolean simulationTerminee()
        -void draw()
        -void drawCarte()
        -void drawElementBord(Case c, String[] sprites, Carte carte, boolean coin)
        -void drawCase(int xCase, int yCase, Random random, Case c, Carte carte)
        -void drawIncendies()
        -void drawRobots()
        -void drawRobot(Robot robot)
        -int calculateXPosition(int colonne)
        -int calculateYPosition(int ligne)
        -void drawRobotRectangles(int[][]coordinates, int x, int y, Color robotColor, int tailleElement)
        -void drawRectangle(int x, int y, int tailleCases, Color color)
        -void drawRobotPixel(Robot robot)
        -void int[][] getRobotCoordinates()
        +void next()
        +void restart()
    }
    class TestSimulateur{
        +{static} Scenario createScenario(String numScenario)
        +{static} void main(String[] args)
    }

    package scenario {
        class Scenario1 {
            +void createEvenements(Simulateur simulateur, DonneesSimulation model)
        }
        class Scenario0{
            +void createEvenements(Simulateur simulateur, DonneesSimulation model)
        }

        interface Scenario {
            +{abstract} void createEvenements(Simulateur simulateur, DonneesSimulation model)
        }
    }
    
}




@enduml